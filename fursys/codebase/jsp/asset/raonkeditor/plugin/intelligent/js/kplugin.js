(function(){try{var H=function(b,d){var e;e=b;"selectarea"==e.toLowerCase()?e="selectArea":"selectedmulticell"==e.toLowerCase()?e="selectedMultiCell":"cellselecttext"==e.toLowerCase()?e="cellSelectText":"focusimage"==e.toLowerCase()?e="focusImage":"focusflash"==e.toLowerCase()?e="focusFlash":"focusvideo"==e.toLowerCase()?e="focusVideo":"focusiframe"==e.toLowerCase()?e="focusIframe":"focusmedia"==e.toLowerCase()?e="focusMedia":"focuslinkmedia"==e.toLowerCase()?e="focusLinkMedia":"focuschart"==e.toLowerCase()&&
(e="focusChart");e!=b&&(d[e]=d[b],delete d[b]);d[e]&&(d[e].tool1&&(d[e].tool1=d[e].tool1.toLowerCase().split(",")),d[e].tool2&&(d[e].tool2=d[e].tool2.toLowerCase().split(",")));return e},I=function(){for(var c=b._currEditor,d=c._config,e=null,a="",f=0,g=G_ICON_FULL_SET.length;f<g;f++)if(a=KEDITORTOP.RAONKEDITOR.util.trim(G_ICON_FULL_SET[f]).toLowerCase(),e=b._menu_document.getElementById("intel_ue_"+c.ID+a))a=function(a){return function(e){if("formatting"==a||"font_family"==a||"font_size"==a||"line_height"==
a||"letter_spacing"==a||"align_group"==a||"table_group"==a||-1<a.indexOf("detail")){var f=!1;b._whatClick=!1;var g=null;switch(a){case "font_family":"1"==d.useFontFamilyKeyin&&(f=!0);break;case "font_size":"1"==d.useFontSizeKeyin&&(f=!0);break;case "line_height":"1"==d.useLineHeightKeyin&&(f=!0)}if(f)g=b._menu_document.getElementById("intel_txtarea_"+c.ID+a);else if(g=b._menu_document.getElementById("intel_"+c.ID+a),"align_group"==a||"table_group"==a)g=b._menu_document.getElementById("intel_ue_"+
c.ID+a);b.intelligentClickIconRect=getClientRect(g)}else b._whatClick=!0;c._editorCommands(c.ID,a);KEDITORTOP.RAONKEDITOR.util.stopEvent(e)}}(a),KEDITORTOP.RAONKEDITOR.util.addEvent(e,"click",a)},C=function(c){var d=b._currEditor,e=d._config,a='<span class="cover" id="intel_span'+d.ID+c+'">';switch(c){case "formatting":case "line_height":case "letter_spacing":case "font_family":case "font_size":var f=!1;switch(c){case "font_family":"1"==e.useFontFamilyKeyin&&(f=!0);break;case "font_size":"1"==e.useFontSizeKeyin&&
(f=!0);break;case "line_height":"1"==e.useLineHeightKeyin&&(f=!0)}if(f){if(a+='<textarea class="textType" id = "intel_txtarea_'+d.ID+c+'" title = "'+RAONKEditor_lang.icon[c].replace("\uae30\ubcf8","")+'"></textarea >',a+='<a class="con_button textAreaDropDown" id = "intel_dropdown_'+d.ID+c+'" href="javascript:;">',a+='<span class="arrowToDrop" id="intel_ue_'+d.ID+c+'"></span>',a+="</a>","font_size"==c&&"1"==e.useFontSizeIncDec||"line_height"==c&&"1"==e.useLineHeightIncDec)a+='<span class="btn_upDown_Area" id="intel_'+
d.ID+c+'IncDec">',a+='<a class="up" href="javascript:;" id="intel_ue_'+d.ID+c+'_inc" style="cursor: pointer;"></a>',a+='<a class="down" href="javascript:;" id="intel_ue_'+d.ID+c+'_dec" style="cursor: pointer;"></a>'}else if(a+='<a class="con_button btnType" id = "intel_'+d.ID+c+'"title = "'+RAONKEditor_lang.icon[c].replace("\uae30\ubcf8","")+'" href="javascript:;">',a+='<span class="txtArea" id="intel_ue_'+d.ID+c+'"></span>',a+="</a>","font_size"==c&&"1"==e.useFontSizeIncDec||"line_height"==c&&"1"==
e.useLineHeightIncDec||"letter_spacing"==c&&"1"==e.useLetterSpacingIncDec)a+='<span class="btn_upDown_Area" id="intel_'+d.ID+c+'IncDec">',a+='<a class="up" href="javascript:;" id="intel_ue_'+d.ID+c+'_inc" style="cursor: pointer;" title = "'+RAONKEditor_lang.icon[c].replace("\uae30\ubcf8","")+'"></a>',a+='<a class="down" href="javascript:;" id="intel_ue_'+d.ID+c+'_dec" style="cursor: pointer;" title = "'+RAONKEditor_lang.icon[c].replace("\uae30\ubcf8","")+'"></a>';a+='\t<span style="display:block;position:absolute; z-index:'+
(G_MAIN_ZINDEX+2E3)+'">';a+='\t\t<span id="keditor_intel_span_'+c+"_"+d.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';a+="\t</span></span>";break;case "font_color":a+='<span class="con_button"  title="'+RAONKEditor_lang.icon[c]+'">';a+='<a class="icon '+c+'" href="javascript:;" id="intel_ue_'+d.ID+c+'">';a+='<em class="editor_font_color_basic" id="intel_em_'+d.ID+'color_show"></em>';a+="</a>";a+='<span class="con_button" id="intel_'+
d.ID+'detail_font_color">';a+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+d.ID+'detail_font_color"></a>';a+="</span>";a+="</span>";break;case "font_bg_color":a+='<span class="con_button"  title="'+RAONKEditor_lang.icon[c]+'">';a+='<em class="editor_bg_color_basic" id="intel_em_'+d.ID+'bg_color_show"></em>';a+='<a class="icon '+c+'" href="javascript:;" id="intel_ue_'+d.ID+c+'">';a+="</a>";a+='<span class="con_button" id="intel_'+d.ID+'detail_font_bg_color">';a+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+
d.ID+'detail_font_bg_color"></a>';a+="</span>";a+="</span>";break;case "list_number":a+='<span class="con_button"  title="'+RAONKEditor_lang.icon[c]+'">';a+='<a class="icon '+c+'" href="javascript:;" id="intel_ue_'+d.ID+c+'">';a+="</a>";a+='<span class="con_button" id="intel_'+d.ID+'detail_list_number">';a+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+d.ID+'detail_list_number"></a>';a+="</span>";a+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+
'">';a+='\t\t<span id="keditor_intel_span_detail_list_number_'+d.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';a+="\t</span>";a+="</span>";break;case "list_bullets":a+='<span class="con_button"  title="'+RAONKEditor_lang.icon[c]+'">';a+='<a class="icon '+c+'" href="javascript:;" id="intel_ue_'+d.ID+c+'">';a+="</a>";a+='<span class="con_button" id="intel_'+d.ID+'detail_list_bullets">';a+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+
d.ID+'detail_list_bullets"></a>';a+="</span>";a+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';a+='\t\t<span id="keditor_intel_span_detail_list_bullets_'+d.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';a+="\t</span>";a+="</span>";break;case "align_group":a+='<span class="con_button"  title="'+RAONKEditor_lang.icon[c]+'">';a+='<a class="icon '+c+'" href="javascript:;" id="intel_ue_'+
d.ID+c+'">';a+="</a>";a+='<span class="con_button" id="intel_'+d.ID+'align_group_detail">';a+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+d.ID+'align_group_detail"></a>';a+="</span>";a+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';a+='\t\t<span id="keditor_intel_span_align_group_detail_'+d.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';a+=
"\t</span>";a+="</span>";break;case "table_group":a+='<span class="con_button"  title="'+RAONKEditor_lang.icon[c]+'">';a+='<a class="icon '+c+'" href="javascript:;" id="intel_ue_'+d.ID+c+'">';a+="</a>";a+='<span class="con_button" id="intel_'+d.ID+'table_group_detail">';a+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+d.ID+'table_group_detail"></a>';a+="</span>";a+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';a+='\t\t<span id="keditor_intel_span_table_group_detail_'+
d.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';a+="\t</span>";a+="</span>";break;case "order_of_objects":a+='<span class="con_button"  title="'+RAONKEditor_lang.icon[c]+'">';a+='<a class="icon '+c+'" href="javascript:;" id="intel_ue_'+d.ID+c+'">';a+="</a>";a+='<span class="con_button" id="intel_'+d.ID+'order_of_objects_detail">';a+='<a style="" href="javascript:;" class="arrowToDrop" id="intel_ue_'+
d.ID+'order_of_objects_detail"></a>';a+="</span>";a+='\t<span style="display:block;position:absolute; z-index:'+(G_MAIN_ZINDEX+2E3)+'">';a+='\t\t<span id="keditor_intel_span_order_of_objects_detail_'+d.ID+'" style="cursor:pointer; background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></span>';a+="\t</span>";a+="</span>";break;default:if(0==c.indexOf("p_")){var g=c.split("_"),e=g[1],f="icon";2<g.length&&(f=g[2]);g="";KEDITORTOP.RAONKEDITOR.browser.ie&&
(g="vertical-align:bottom; ");a+='<a class="con_button" id="intel_ue_'+d.ID+c+'" href="javascript:;" title="'+RAONKEditor_lang.icon[c]+'">';a+='<span id="intel_ue_'+d.ID+c+'" href="javascript:;">';a+='<img style="'+g+'margin: 3px; width: 20px; height: 20px;" id="intel_ue_'+d.ID+c+'" title="" src="'+d._config.webPath.plugin+e+"/images/"+f+'.png" />'}else a+='<a class="con_button" id="intel_ue_'+d.ID+c+'" href="javascript:;" title="'+RAONKEditor_lang.icon[c]+'">',a+='<span class="icon '+c+'" id="intel_ue_'+
d.ID+c+'" href="javascript:;">';a+="</span>";a+="</a>"}return a+="</span>"},D=function(c){var d=!0;void 0==b._intelligent_menu_iframe.style.opacity&&(d=!1);0==c?b.hide():d?b._intelligent_menu_iframe.style.opacity=c:b._intelligent_menu_iframe.style.filter="alpha(opacity="+100*c+")"},B=function(c){var d={};d.clientX=c.clientX;d.clientY=c.clientY;d.button=c.button;var e=b._intelligent_menu_iframe;setTimeout(function(){var a=c;"number"!=typeof c.button&&(a=d);if(2!=a.button&&"none"==e.style.display){var f=
b._currEditor.iconEnableCommandType,g=a,l=b._currEditor;"1"==l._config.clickCtrlHyperlink&&l.isAOver.openHelp&&l._FRAMEWIN.hyperHelpClose();var m=b.intelligentMenu,a=g.target?g.target:g.srcElement,h=a.tagName.toLowerCase();if(m[f]){"div"==h&&(a=KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT,h=a.tagName.toLowerCase());"img"==h?"focusImage"==f&&(h=a.getAttribute("keditorcustomdata"),null!=h&&void 0!=h?(h=getKEditorCustomData(h),"iframe"==h.type?f="focusIframe":"flash"==h.type?f="focusFlash":"media"==h.type?
f="focusMedia":"link_media"==h.type?f="focusLinkMedia":"video_media"==h.type&&(f="focusVideo")):a.getAttribute("raon_chart")&&G_KPlugin.chart&&(f="focusChart"),KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT=a):"video"==h&&(f="focusVideo",KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT=a);var h=m[f].tool1,m=m[f].tool2,n=b._currEditor,k=b._menu_document.getElementById("first_intelligent"),p=b._menu_document.getElementById("last_intelligent"),q=!1,w=!1,t=null;if(h){var u=h.length;if(0<u)for(var q=!0,y=0;y<u;y++){var x=
!1,t=KEDITORTOP.RAONKEDITOR.util.trim(h[y]);"chart"==t&&(t="p_chart");"separator"==t&&(x=!0);var r=b._menu_document.getElementById("intel_span"+n.ID+t);x&&(r=b._menu_document.createElement("i"),r.className="separationVI");var v=b._menu_document.getElementById("intel_txtarea_"+n.ID+t);null!=v&&KEDITORTOP.RAONKEDITOR.util.addEvent(v,"keydown",E);z(t,r);r&&(null==k.lastChild?0==x&&k.appendChild(r):"separationVI"==k.lastChild.className?0==x&&k.appendChild(r):k.appendChild(r))}}if(m){if(u=m.length,0<u){w=
!0;for(y=0;y<u;y++)x=!1,t=KEDITORTOP.RAONKEDITOR.util.trim(m[y]),"chart"==t&&(t="p_chart"),"separator"==m[y]&&(x=!0),r=b._menu_document.getElementById("intel_span"+n.ID+t),x&&(r=b._menu_document.createElement("i"),r.className="separationVI"),v=b._menu_document.getElementById("intel_txtarea_"+n.ID+t),null!=v&&KEDITORTOP.RAONKEDITOR.util.addEvent(v,"keydown",E),z(t,r),r&&(null==p.lastChild?0==x&&p.appendChild(r):"separationVI"==p.lastChild.className?0==x&&p.appendChild(r):p.appendChild(r));k.className=
"inCon"}}else k.className="inCon inCon_last",p.style.display="none";q&&0==w&&(k.className="inCon inCon_last");0<k.childNodes.length?"separationVI"==k.lastChild.className&&k.removeChild(k.lastChild):(h=null,k.style.display="none");0<p.childNodes.length?"separationVI"==p.lastChild.className&&p.removeChild(p.lastChild):(m=null,p.style.display="none");if(null!=h||null!=m){b._intelligent_menu_iframe.style.width="100%";b._intelligent_menu_iframe.style.height="";b._intelligent_menu_iframe.style.display=
"";m=getClientRect(b._menu_document.body.firstChild);h=m.right-m.left;m=m.bottom-m.top;b._intelligent_menu_iframe.style.width=h+"px";b._intelligent_menu_iframe.style.height=m+"px";n=k=0;l=getClientRect(document.getElementById("keditor_design_"+l.ID));if("selectArea"==f||"cellSelectText"==f)k=g.clientX,n=g.clientY,k+=10,n+=l.top-40,n-=m/2,k+h>=l.right&&(f=k+h-l.right,k-=f+1),0>k&&(k=1),n<=l.top&&(n=l.top+1+35),n+m>=l.bottom&&(f=n+m-l.bottom+45,n-=f-1);else{g=GetTableSelectionCells();if(0<g.length){n=
g.length;f={};for(k=0;k<n;k++)p=getClientRect(g[k]),0==k?(f.left=p.left,f.right=p.right,f.bottom=p.bottom,f.top=p.top):(p.left<f.left&&(f.left=p.left),p.top<f.top&&(f.top=p.top),p.bottom>f.bottom&&(f.bottom=p.bottom),p.right>f.right&&(f.right=p.right));f.height=f.bottom-f.top;f.width=f.right-f.left}else f=getClientRect(KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT);k=f.right-f.left;n=f.bottom-f.top;q=p=!1;f.bottom+m+l.top<l.bottom&&(p=!0);0==p&&0<f.top-m&&(q=!0);g=null;p?(g=b._menu_document.getElementById("tooltip_up"),
g.style.display="",n=f.bottom+l.top+10):q?(g=b._menu_document.getElementById("tooltip_down"),g.style.display="",n=f.top+l.top-m-10):n=n/2-m/2;k=f.left+k-k/2-h/2;m=h/2-5;0>k?(m+=k,k=1):k+h>l.right&&(f=k+h-l.right,m+=f,k-=f);g&&(g.style.left=m+"px")}b.intelligentLocationRectLeft=k-1;b.intelligentLocationRectBottom=n;b._intelligent_menu_iframe.style.left=k+"px";b._intelligent_menu_iframe.style.top=n+"px";b.intelligentLocationRectTop=parseInt(b._intelligent_menu_iframe.style.top);if(a.tagName&&"BODY"==
a.tagName||"HTML"==a.tagName)try{var A=getFirstRange().range.endContainer;3==A.nodeType&&(A=A.parentNode);a=A}catch(B){}setMenuIconRealable(a);D(1)}}}},50)},J=function(){setTimeout(function(){"selectArea"!=b._currEditor.iconEnableCommandType&&"cellSelectText"!=b._currEditor.iconEnableCommandType?b.hide("dblclick"):KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT&&"a"==KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT.nodeName.toLowerCase()&&b.hide()},50)},K=function(){command_InsertTableTopBottomParagraph(b._paragraphLocation,
b._currEditor,b._paragraphTargetTable);b.insertParagraphTable.style.display="none"},z=function(c,d){if(0==c.indexOf("p_")){var e=c.split("_")[1];d?d.getElementsByTagName("img")[0].title=b._currEditor._FRAMEWIN.RAONKEditor_lang.plugins[e].intelligentMenu[c]:G_KPlugin[e]&&0>G_ICON_FULL_SET.indexOf(c)&&G_ICON_FULL_SET.push(c)}},L=function(c){var d=b._currEditor,e=b.intelligentMenu;c+='<div id="iconHouse" style="display:none;">';var a=[],f;for(f in e)a.push(H(f,e));f="";for(var d=d.remove_item,g=0;g<
a.length;g++){var l=a[g];if(void 0!=e[l]){var m=e[l].tool1,l=e[l].tool2,h=null;if(m){var n=m.length;if(0<n)for(var k=0;k<n;k++)h=KEDITORTOP.RAONKEDITOR.util.trim(m[k]),"chart"==h&&(h="p_chart"),0>d.indexOf(h)&&"separator"!=h&&-1==f.indexOf(","+h+",")&&(z(h),c+=C(h),f+=","+h+",")}if(l&&(n=l.length,0<n))for(k=0;k<n;k++)h=KEDITORTOP.RAONKEDITOR.util.trim(l[k]),"chart"==h&&(h="p_chart"),0>d.indexOf(h)&&"separator"!=h&&-1==f.indexOf(","+h+",")&&(z(h),c+=C(h),f+=","+h+",")}}return c},M=function(c){c="which"in
c?c.which:c.keyCode;if(46==c||c!=b.keyDownCode)b.keyDownCode=c,b.hide()},u=function(c,d){if("1"==b.intelligentMenu.Use&&null!=b.intelligentClickIconRect){var e=b._intelligent_menu_iframe,a={},a=getWindowScrollPos(KEDITORTOP.KEDITORWIN),f=null,f=d?getClientRect(b._menu_document.getElementById("intel_ue_"+b._currEditor.ID+d)):b.intelligentClickIconRect,e=getClientRect(e),g=getClientRect(_iframeWin.parent.frameElement),l=0;7==KEDITORTOP.RAONKEDITOR.browser.ieVersion&&(l=-2);var m=0;e.left+f.left+g.left+
180>=g.right&&(m=e.left+f.left+g.left+180-g.right+10);c._iframe.style.left=f.left+g.left+a[0]+e.left-m+"px";c._iframe.style.top=f.bottom+a[1]+e.top+l+g.top+"px"}},v=function(c,d){if("1"==b.intelligentMenu.Use&&null!=b.intelligentClickIconRect){var e={},e=getWindowScrollPos(KEDITORTOP.KEDITORWIN),a=b.intelligentClickIconRect,f=a.left+b.intelligentLocationRectLeft,a=a.bottom+b.intelligentLocationRectBottom,g=getClientRect(_iframeWin.parent.frameElement),l=0;d&&f+g.left+180>=g.right&&(l=f+g.left+180-
g.right+10);var m=0;7==KEDITORTOP.RAONKEDITOR.browser.ieVersion&&(m=-2);c._iframeHolder?(c._iframeHolder.style.left=f+e[0]+g.left-l+"px",c._iframeHolder.style.top=a+e[1]+g.top+m+"px",c._iframeHolder.style.display=""):(c._iframe.style.left=f+e[0]+g.left-l+"px",c._iframe.style.top=a+e[1]+g.top+m+"px");c._iframe.style.display=""}},O=function(){var b=setMenuIconRealable;setMenuIconRealable=function(d){d=b(d);N(d)}},P=function(){var c=KEDITORTOP.G_CURRKEDITOR._iconSelected;KEDITORTOP.G_CURRKEDITOR._iconSelected=
function(d){c(d);if("none"!=b._intelligent_menu_iframe.style.display){for(var e="bold italic underline align_left align_center align_right align_full strike_through subscript superscript full_screen grid list_number list_bullets dirltr dirrtl show_blocks table_lock cell_lock table_lock_property font_color font_bg_color table_border".split(" "),a=b._currEditor,f="",g=0,l=e.length;g<l;g++)if(_icon_id=KEDITORTOP.RAONKEDITOR.util.trim(e[g]).toLowerCase(),_icon_a=b._menu_document.getElementById("intel_ue_"+
a.ID+_icon_id))f=KEDITORTOP.RAONKEDITOR.util.getClass(_icon_a),f=KEDITORTOP.RAONKEDITOR.util.replaceAll(f,"Enter",""),f=KEDITORTOP.RAONKEDITOR.util.trim(f),KEDITORTOP.RAONKEDITOR.util.setClass(_icon_a,f),_icon_a.style.backgroundImage="";if(d)for(g=0,l=d.length;g<l;g++)if(_icon_id=KEDITORTOP.RAONKEDITOR.util.trim(d[g]).toLowerCase(),_icon_a=b._menu_document.getElementById("intel_ue_"+a.ID+_icon_id))f=KEDITORTOP.RAONKEDITOR.util.getClass(_icon_a),f+=" Enter",KEDITORTOP.RAONKEDITOR.util.setClass(_icon_a,
f)}}},Q=function(){var c=b._currEditor._kEditorFontFamily.show;b._currEditor._kEditorFontFamily.show=function(a){c(a);v(b._currEditor._kEditorFontFamily,!0)};var d=b._currEditor._kEditorFontSize.show;b._currEditor._kEditorFontSize.show=function(a){d(a);v(b._currEditor._kEditorFontSize,!0)};var e=b._currEditor._kEditorFormatting.show;b._currEditor._kEditorFormatting.show=function(a){e(a);v(b._currEditor._kEditorFormatting,!1)};var a=b._currEditor._kEditorLineHeight.show;b._currEditor._kEditorLineHeight.show=
function(c){a(c);v(b._currEditor._kEditorLineHeight,!1)};var f=b._currEditor._kEditorLetterSpacing.show;b._currEditor._kEditorLetterSpacing.show=function(a){f(a);v(b._currEditor._kEditorLetterSpacing,!1)};var g=b._currEditor._kEditorListNumber.show;b._currEditor._kEditorListNumber.show=function(a){g(a);u(b._currEditor._kEditorListNumber)};var l=b._currEditor._kEditorListBullets.show;b._currEditor._kEditorListBullets.show=function(a){l(a);u(b._currEditor._kEditorListBullets)};var m=b._currEditor._kEditorListAligns.show;
b._currEditor._kEditorListAligns.show=function(a){m(a);u(b._currEditor._kEditorListAligns,"align_group_detail")};var h=b._currEditor._kEditorListTables.show;b._currEditor._kEditorListTables.show=function(a){h(a);u(b._currEditor._kEditorListTables,"table_group_detail")};var n=b._currEditor._kEditorElementZindex.show;b._currEditor._kEditorElementZindex.show=function(a){n(a);u(b._currEditor._kEditorElementZindex)}},R=function(){var c=hyperHelpOpen;hyperHelpOpen=function(d,e){"none"==b._intelligent_menu_iframe.style.display&&
c(d,e)}},S=function(){var b=command_fontSizeIncDec;command_fontSizeIncDec=function(a,d,e){b(a,d,e);w("font_size",a)};var d=command_letterSpacingIncDec;command_letterSpacingIncDec=function(a,b,c){d(a,b,c);w("letter_spacing",a)};var e=command_lineHeightIncDec;command_lineHeightIncDec=function(a,b,c){e(a,b,c);w("line_height",a)}},w=function(c,d){"none"!=b._intelligent_menu_iframe.style.display&&("1"==KEDITORTOP.G_CURRKEDITOR._config.useLineHeightKeyin&&-1<c.indexOf("line_height")||"1"==KEDITORTOP.G_CURRKEDITOR._config.useFontSizeKeyin&&
-1<c.indexOf("font_size")||"1"==KEDITORTOP.G_CURRKEDITOR._config.useFontFamilyKeyin&&-1<c.indexOf("font_family")?b._menu_document.getElementById("intel_txtarea_"+d+c).value=document.getElementById("txtara_"+d+c).value:b._menu_document.getElementById("intel_ue_"+d+c).innerHTML=document.getElementById("ue_"+d+c).innerHTML)},T=function(){var c=b._currEditor._kEditorFontFamily.click_func;b._currEditor._kEditorFontFamily.click_func=function(a,b,d){c(a,b,d);w("font_family",a)};var d=b._currEditor._kEditorFontSize.click_func;
b._currEditor._kEditorFontSize.click_func=function(a,b,c){d(a,b,c);w("font_size",a)};var e=b._currEditor._kEditorFormatting.click_func;b._currEditor._kEditorFormatting.click_func=function(a,b){e(a,b);w("formatting",a)};var a=b._currEditor._kEditorLetterSpacing.click_func;b._currEditor._kEditorLetterSpacing.click_func=function(b,c){a(b,c);w("letter_spacing",b)};var f=b._currEditor._kEditorLineHeight.click_func;b._currEditor._kEditorLineHeight.click_func=function(a,b,c){f(a,b,c);w("line_height",a)}},
q=function(c,d,e){return null!=b.intelligentClickIconRect?b._menu_document.getElementById("keditor_intel_span"+d+b._currEditor.ID):e(c)},U=function(){var c=b._currEditor._kEditorFontFamily._self;b._currEditor._kEditorFontFamily._self=function(a){return q(a,"_font_family_",c)};var d=b._currEditor._kEditorFontSize._self;b._currEditor._kEditorFontSize._self=function(a){return q(a,"_font_size_",d)};var e=b._currEditor._kEditorFormatting._self;b._currEditor._kEditorFormatting._self=function(a){return q(a,
"_formatting_",e)};var a=b._currEditor._kEditorLineHeight._self;b._currEditor._kEditorLineHeight._self=function(b){return q(b,"_line_height_",a)};var f=b._currEditor._kEditorLetterSpacing._self;b._currEditor._kEditorLetterSpacing._self=function(a){return q(a,"_letter_spacing_",f)};var g=b._currEditor._kEditorListNumber._self;b._currEditor._kEditorListNumber._self=function(a){return q(a,"_detail_list_number_",g)};var l=b._currEditor._kEditorListBullets._self;b._currEditor._kEditorListBullets._self=
function(a){return q(a,"_detail_list_bullets_",l)};var m=b._currEditor._kEditorListAligns._self;b._currEditor._kEditorListAligns._self=function(a){return q(a,"_align_group_detail_",m)};var h=b._currEditor._kEditorListTables._self;b._currEditor._kEditorListTables._self=function(a){return q(a,"_table_group_detail_",h)};var n=b._currEditor._kEditorElementZindex._self;b._currEditor._kEditorElementZindex._self=function(a){return q(a,"_order_of_objects_detail_",n)}},F=function(c,d){var e=b._menu_document.getElementById("intel_em_"+
b._currEditor.ID+d);c&&(e.style.backgroundColor=c)},V=function(){var b=command_fontColor;command_fontColor=function(d,a,f){b(d,a,f);F(f,"color_show")};var d=command_fontBgColor;command_fontBgColor=function(b,a,c){d(b,a,c);F(c,"bg_color_show")}},N=function(c){if(c){var d=c.formattingVal,e=c.lineHeightVal,a=c.fontSizeVal,f=c.fontFamilyVal;c=c.fontLetterSpacingVal;var g=b._currEditor,l=g._config,m=b._menu_document.getElementById("intel_ue_"+g.ID+"formatting");m&&(m.innerHTML=d);d=null;if("1"==l.useLineHeightKeyin){if(d=
b._menu_document.getElementById("intel_txtarea_"+g.ID+"line_height"))d.value=e}else if(d=b._menu_document.getElementById("intel_ue_"+g.ID+"line_height"))d.innerHTML=e;e=null;if(e="1"==l.useFontSizeKeyin?b._menu_document.getElementById("intel_txtarea_"+g.ID+"font_size"):b._menu_document.getElementById("intel_ue_"+g.ID+"font_size")){try{if(-1<a.indexOf(".")){d="";-1<a.indexOf("px")||-1<a.indexOf("pt")||-1<a.indexOf("em")?d=a.substring(a.length-2):-1<a.indexOf("%")&&(d=a.substring(a.length-1));var h=
parseFloat(a),h=Math.round(h),a=h+d}}catch(n){}"1"==l.useFontSizeKeyin?e.value=a:e.innerHTML=a}a=null;if("1"==l.useFontFamilyKeyin){if(a=this._menu_document.getElementById("intel_txtarea_"+g.ID+"font_family"))a.value=f}else if(a=b._menu_document.getElementById("intel_ue_"+g.ID+"font_family"))a.innerHTML=f;if(f=b._menu_document.getElementById("intel_ue_"+g.ID+"letter_spacing"))f.innerHTML=c}},b={pluginName:"intelligent",_id:"",_zIndex:0,_currEditor:null,intelligentClickIconRect:null,intelligentLocationRectLeft:null,
intelligentLocationRectBottom:null,intelligentLocationRectTop:null,_paragraphLocation:"",_paragraphTargetTable:null,_whatClick:!0,colorPicker:!1,_intelligent_menu_iframe:null,keyDownCode:null,_colorData:null};G_KPlugin.intelligent=b;b.onInit=function(){var c="../plugin/intelligent/js"+(KEDITORTOP.RAONKEDITOR.isRelease?"":"_dev")+"/config.js",c="1"==KEDITORTOP.G_CURRKEDITOR._config.useConfigTimeStamp?c+("?t="+KEDITORTOP.RAONKEDITOR.util.getTimeStamp()):c+("?ver="+KEDITORTOP.RAONKEDITOR.ReleaseVer),
d=document.getElementsByTagName("head")[0],e=document.createElement("script");e.type="text/javascript";e.src=c;d.appendChild(e);if(KEDITORTOP.RAONKEDITOR.browser.ie&&9>KEDITORTOP.RAONKEDITOR.browser.ieVersion||KEDITORTOP.RAONKEDITOR.browser.mobile)b.intelligentMenu.Use="0",b.InsertParagraph="0"};b.onInitOnce=function(c){"1"==b.intelligentMenu.Use&&b.addEvent(c.editor)};b.onInit();b.onLoaded=function(){this._currEditor=KEDITORTOP.G_CURRKEDITOR;var c=b._currEditor._config;if("0"!=b.intelligentMenu.Use||
"0"!=b.InsertParagraph){if("1"==b.intelligentMenu.Use){this._id="editor_intelligent_menu_iframe_"+b._currEditor.ID;var d=document.getElementById(this._id);d&&d.parentNode.removeChild(d);this._zIndex=G_MAIN_ZINDEX+900;if(d=document.getElementById(this._id))c=d.contentWindow.document,b._intelligent_menu_iframe=d,this._menu_document=c;else{try{d=document.createElement("iframe")}catch(e){d=document.createElement("<iframe>")}d.id=this._id;d.style.margin="0px";d.style.padding="0px";d.style.zIndex=this._zIndex;
d.style.position="absolute";d.scrolling="no";d.style.overflow="auto";d.style.overflowX="hidden";d.style.display="none";d.allowTransparency="true";d.frameBorder="0";document.body.appendChild(d);var a="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();",a=KEDITORTOP.RAONKEDITOR.browser.ie?"javascript:void(function(){"+encodeURIComponent(a)+"}())":"";d.src=a;a="";a=KEDITORTOP.RAONKEDITOR.isRelease?c.webPath.plugin+"intelligent/css/":c.webPath.plugin+
"intelligent/css_dev/";a="<!DOCTYPE html><html><head>"+('<link rel="stylesheet" type="text/css" href="'+a+"editor_intelligent.css?ver="+KEDITORTOP.RAONKEDITOR.ReleaseVer+'" charset="utf-8">');a+="</head>";a+="<body>";a+='<div class="intelligent_K sKin_'+c.style.skinName+'">';a+='<div class="itelligent_con" id="intelligent_holder">';a+='<div class="inCon{0}" id="first_intelligent"></div>';a+='<div class="inCon inCon_last" id="last_intelligent"></div>';a+="</div>";a+='<span id="tooltip_up" class="tooltipOnTop" style="left: 30%; display:none;"></span>';
a+='<span id="tooltip_down" class="tooltipOnBottom" style="left: 30%; display:none;"></span>';a+="</div>";a=L(a);a+="</div>";a+="</body></html>";c=d.contentWindow.document;c.open("text/html","replace");isCustomDomain(document)&&(c.domain=document.domain);c.write(a);c.close();b._intelligent_menu_iframe=d;this._menu_document=c;I();KEDITORTOP.RAONKEDITOR.util.addEvent(c,"dragover",function(a){KEDITORTOP.RAONKEDITOR.util.cancelEvent(a);return!1});KEDITORTOP.RAONKEDITOR.util.addEvent(c,"drop",function(a){KEDITORTOP.RAONKEDITOR.util.cancelEvent(a);
return!1})}V();U();T();S();R();P();Q();O()}"1"==b.InsertParagraph&&(null==document.getElementById("insert_paragraph_table")&&(c=document.createElement("div"),d='<div id="insert_paragraph_table" style="width: 100%; position: absolute; display:none;"><div style="position:relative; width: 100%; height:9px;"><div style="background-color:#6D90E0; width:98%; width:calc(100%); margin:9px auto; height:2px; *font-size:2px">',d+='<a href="#"><span id="insertParagraph_'+b._currEditor.ID+'"style="position: absolute; background:url(../plugin/intelligent/images/intelligent/arrow.png) 38% 50% no-repeat #6D90E0; width:11px; height:11px; border:1px solid #4677DB; display:inline-block; margin:auto; *margin-left:-6px; left:0; right:0; *left:50%; top:-5px; *top:4px; bottom:0; *font-size:9px"></span></a>',
d+="</div>",d+='<i style="position:absolute; display:block; top:-6px; *top:3px; left:0; width:0; height:0; border-top:7px solid transparent;border-bottom:7px solid transparent; border-left:8px solid #6D90E0; border-right:10px solid none; *font-size:0px"></i>',d+='<i style="position:absolute; display:block; top:-6px; *top:3px; right:0; width:0; height:0; border-top:7px solid transparent;border-bottom:7px solid transparent; border-left:8px solid none; border-right:10px solid #6D90E0; *font-size:0px"></i>',
d+="</div>",d+="</div>",c.innerHTML=d,document.body.appendChild(c.firstChild),KEDITORTOP.RAONKEDITOR.util.addEvent(document.getElementById("insertParagraph_"+b._currEditor.ID),"click",K),KEDITORTOP.RAONKEDITOR.util.addEvent(b._currEditor._DOC,"mouseover",G,!0)),this.insertParagraphTable=document.getElementById("insert_paragraph_table"),this.insertParagraphTableGap=40);KEDITORTOP.RAONKEDITOR.util.addEvent(b._currEditor._DOC,"mousedown",this.hide,!0);b.addEvent(b._currEditor)}};b.addEvent=function(c){b._currEditor&&
("1"==b.intelligentMenu.Use&&(KEDITORTOP.RAONKEDITOR.util.addEvent(c._DOC,"mousedown",this.hide,!0),KEDITORTOP.RAONKEDITOR.util.addEvent(c._DOC,"keydown",M,!0),KEDITORTOP.RAONKEDITOR.util.addEvent(c._DOC,"mouseup",B,!0),KEDITORTOP.RAONKEDITOR.util.addEvent(c._DOC,"dblclick",J,!0),document.getElementById("ue_toolbar_"+c.ID)&&KEDITORTOP.RAONKEDITOR.util.addEvent(document.getElementById("ue_toolbar_"+c.ID),"mousemove",this.hide,!0),document.getElementById("keditor_topstatusbar_"+c.ID)&&KEDITORTOP.RAONKEDITOR.util.addEvent(document.getElementById("keditor_topstatusbar_"+
c.ID),"mousemove",this.hide,!0),KEDITORTOP.RAONKEDITOR.util.addEvent(c._DOC,"mousemove",W,!0)),"1"==b.InsertParagraph&&KEDITORTOP.RAONKEDITOR.util.addEvent(c._DOC,"mouseover",G,!0),KEDITORTOP.RAONKEDITOR.browser.gecko?KEDITORTOP.RAONKEDITOR.util.addEvent(c._DOC,"DOMMouseScroll",this.hide,!0):KEDITORTOP.RAONKEDITOR.util.addEvent(c._DOC,"mousewheel",this.hide,!0))};b.hide=function(){var c=b._currEditor;if("1"==b.intelligentMenu.Use&&b._intelligent_menu_iframe&&"none"!=b._intelligent_menu_iframe.style.display){b._whatClick=
!0;b._intelligent_menu_iframe&&"none"!=b._intelligent_menu_iframe.style.display&&(b._menu_document.getElementById("tooltip_up").style.display="none",b._menu_document.getElementById("tooltip_down").style.display="none",b._intelligent_menu_iframe.style.display="none",b.intelligentClickIconRect=null,b.intelligentLocationRectBottom=null,b.intelligentLocationRectLeft=null);for(var d=b._menu_document.getElementById("iconHouse"),e=b._menu_document.getElementById("first_intelligent"),a=b._menu_document.getElementById("last_intelligent");e.hasChildNodes();)"separationVI"!=
e.firstChild.className?d.appendChild(e.firstChild):e.removeChild(e.firstChild);for(;a.hasChildNodes();)"separationVI"!=a.firstChild.className?d.appendChild(a.firstChild):a.removeChild(a.firstChild);"none"==e.style.display&&(e.style.display="");"none"==a.style.display&&(a.style.display="")}"1"==c._config.useInsertParagraph&&"none"!=b.insertParagraphTable.style.display&&(b.insertParagraphTable.style.display="none")};b.onCommand=function(c){c=c.cmd;"1"==b.intelligentMenu.Use&&-1<"cut table_delete merge_cell delete_row delete_column source preview design text insert_file_property replace emoticon setting horizontal_line image_create image_property flash_property flash_create media_create media_property iframe_create iframe_property hyperlink_create hyperlink_property bookmark doc_bg_image detail_table_insert detail_table_insert_new table_insert split_cell cell_border insert_row_column cell_property row_property column_property table_property about insert_link_media shortcut list_blockquote table_lock_property pastetoimage detail_insert_datetime conversion personal_data forbidden_word video video_property spell_check paragraph_attribute".split(" ").indexOf(c)&&
b.hide()};b.onResize=function(c){var d=c.cmd;"1"==b.intelligentMenu.Use&&("start"==d?"none"!=b._intelligent_menu_iframe.style.display&&b.hide():"end"==d&&"none"==b._intelligent_menu_iframe.style.display&&(d=KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT,KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT=c.target,B(c.event),KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT=d))};b.onCellResize=function(c){var d=c.cmd;"1"==b.intelligentMenu.Use&&("start"==d?"none"!=b._intelligent_menu_iframe.style.display&&b.hide():"end"==
d&&"none"==b._intelligent_menu_iframe.style.display&&(d=KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT,KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT=c.target,B(c.event),KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT=d))};b.onColorPicker=function(c){var d=c.cmd;if("1"==b.intelligentMenu.Use)if("before"==d){if(null!=b.intelligentClickIconRect)return d=c.clickedElem.id.replace("ue_"+b._currEditor.ID,""),c.clickedElem=b._menu_document.getElementById("intel_ue_"+b._currEditor.ID+d),b._colorData=c}else if("show"==d||
"more"==d){if(null!=b.intelligentClickIconRect){var e=b._colorData.targetDoc,d=c.colorPopup,a=d.iframeDoc,f=getClientRect(_iframeWin.frameElement),g=b.intelligentClickIconRect,l=g.left+b.intelligentLocationRectLeft,g=g.bottom+b.intelligentLocationRectBottom,a=a.getElementsByTagName("div")[0],a=getClientRect(a),m=parseInt(a.right,10)-parseInt(a.left,10),a=parseInt(a.bottom,10)-parseInt(a.top,10);if("more"==c.cmd){var h=e.getElementById("popupCover"),h=getClientRect(h);146>f.bottom-a-h.top&&(d.layer.style.top=
parseInt(d.layer.style.top)-146+"px",b.colorPicker=!0)}else{var n=b._colorData.leftX;c=b._colorData.topY;var k=b._colorData.clickedElem,p=getClientRect(k),k=k.ownerDocument||k.document||e;"undefined"!=typeof k.defaultView?h=k.defaultView:"undefined"!=typeof k.parentWindow&&(h=k.parentWindow);e=getDocWindow(e);k=null;h!==e&&(k=getClientRect(h.frameElement));null==n&&(n=0);null==c&&(c=0);if(l+m>=f.right||g+a>f.bottom)d.layer.style.left=k.left+p.left+n+"px",d.layer.style.top=k.top+p.bottom+c+"px",l+
m>=f.right&&(h=l+m-f.right,d.layer.style.left=parseInt(d.layer.style.left)-h+"px"),g+a>f.bottom&&(h=g+a-f.bottom,d.layer.style.top=parseInt(d.layer.style.top)+c-h+"px")}}}else"more_close"==d&&null!=b.intelligentClickIconRect&&b.colorPicker&&(d=document.getElementById("popupCover"),d.style.top=parseInt(d.style.top)+146+"px",b.colorPicker=!1)};var E=function(c){var d=c.target||c.srcElement,e="which"in c?c.which:c.keyCode;try{var a=b._currEditor,f=a.getEditorMode();if(d&&d.tagName&&"textarea"==d.tagName.toLowerCase()){if(13==
e){var g=d.id;switch(g){case "intel_txtarea_"+a.ID+"font_family":case "intel_txtarea_"+a.ID+"font_size":case "intel_txtarea_"+a.ID+"line_height":KEDITORTOP.RAONKEDITOR.util.stopEvent(c),KEDITORTOP.RAONKEDITOR.util.cancelEvent(c),a.dextiframeKeydown=!0}switch(g){case "intel_txtarea_"+a.ID+"font_family":a._kEditorFontFamily.click_func(a.ID,null,d.value);break;case "intel_txtarea_"+a.ID+"font_size":a._kEditorFontSize.click_func(a.ID,null,d.value);break;case "intel_txtarea_"+a.ID+"line_height":a._kEditorLineHeight.click_func(a.ID,
null,d.value)}}return}if(8==e&&"design"==f){KEDITORTOP.RAONKEDITOR.util.cancelEvent(c);return}}catch(l){}evt.ctrlKey&&!evt.altKey&&nextTabKeyAccess(evt,e)&&KEDITORTOP.RAONKEDITOR.util.cancelEvent(evt)},W=function(c){var d=b._currEditor;if(d){var e=b._intelligent_menu_iframe,a=b._currEditor.iconEnableCommandType;if("none"!=e.style.display&&b._whatClick&&("selectArea"==a||"cellSelectText"==a)){var a=parseFloat(e.style.left),f=parseFloat(e.style.top),g=getClientRect(e),e=a+(g.right-g.left),g=f+(g.bottom-
g.top),l=getClientRect(document.getElementById("keditor_design_"+d.ID)),d=c.clientX+l.left;c=c.clientY+l.top;var m=l=0;d<=a?l=a-d:d>=e&&(l=d-e);c<=f?m=f-c:c>=g&&(m=c-g);a=Math.max(l,m);a=30>a?1:120<=a?0:1-1*(a-30)/120;D(a)}}},G=function(c){var d=GetTDTHCell(c.target?c.target:c.srcElement),e=b._currEditor;if(d){if(c=GetParentbyTagName(d,"table")){var a=!1,f=!1;c.previousSibling&&"P"==c.previousSibling.tagName&&(a=!0);c.nextSibling&&"P"==c.nextSibling.tagName&&(f=!0);var g=c.rows.length,l=d.parentNode.rowIndex,
d=getClientRect(c),m=getClientRect(document.getElementById("keditor_design_"+e.ID));0==l&&0==a?(b.insertParagraphTable.style.display="",b.insertParagraphTable.title=e._FRAMEWIN.RAONKEditor_lang.table.top_insert_paragraph,e=getClientRect(b.insertParagraphTable),e=(e.bottom-e.top)/2+1,b.insertParagraphTable.style.left=d.left+1+"px",b.insertParagraphTable.style.width=d.right-d.left+"px",b.insertParagraphTable.style.top=m.top+d.top-e+"px",b._paragraphLocation="insert_table_top_paragraph",b._paragraphTargetTable=
c):l==g-1&&0==f?(b.insertParagraphTable.style.display="",b.insertParagraphTable.title=e._FRAMEWIN.RAONKEditor_lang.table.bottom_insert_paragraph,e=getClientRect(b.insertParagraphTable),e=(e.bottom-e.top)/2,b.insertParagraphTable.style.left=d.left+1+"px",b.insertParagraphTable.style.width=d.right-d.left+"px",b.insertParagraphTable.style.top=m.top+d.bottom-e+"px",b._paragraphLocation="insert_table_bottom_paragraph",b._paragraphTargetTable=c):(b.addParagraphLocation="",b.targetTable=null,b.insertParagraphTable.style.display=
"none")}}else"none"!=b.insertParagraphTable.style.display&&(b.insertParagraphTable.style.display="none")}}catch(X){}})();
